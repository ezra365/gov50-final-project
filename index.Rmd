---
title: "Gov 50 Final Project"
author: "Ezra Sharpe"
description: "Final project"
output:
  distill::distill_article:
    self_contained: false
---

```{r}
library(tidyverse)
library(dplyr)
library(readr)
library(ggplot2)
```

## Introduction 

What are the key relationships which structure European states’ dependency on 
Gazprom’s natural gas exports?

This study will unpack this question using an originally made ‘Gazprom 
Dependency’ dataset, which will facilitate an analysis of what kinds of 
variables influence the relationships Gazprom has with European states. Within 
this broad umbrella question, there are also a range of sub-questions which this
project aims to confront; does reliance on Gazprom natural gas vary between FSU 
countries and non-FSU countries? Over which years are these relationships most 
pronounced? Does reliance on Gazprom natural gas vary between NATO and non-NATO
member states? What are the general trends in changing natural gas production 
levels over time, and what events could be potential drivers of this change? 

Studying Gazprom in close detail is an important research agenda, not least 
because energy has been the main denominator in European states’ (in)ability to
respond to Russian aggressions in the 20th century. For instance, Stern’s (2005)
‘The Future of Russian Gas and Gazprom’ outlined almost two decades ago the 
importance of understanding energy dependency in Europe – and this certainly has
a feeling of foresight given how events transpired ever since in 2014 and 2022.
The research in this context is mainly interesting because of the diversity of 
variables available to analyse within the novel dataset and the broad temporal 
spectrum, with data ranging from 1991 to 2020. Overall, the primary aim of this
study is to understand which political, economic, and militaristic factors 
underpin the different relationships European states have with Gazprom, and why 
these trends may have changed over time. In doing so, we might be able to better
understand how European states can strive for increased energy independence in
the future and divest themselves from Gazprom and the Russian state. 

My null hypothesis, or H(0), is that domestic natural gas production levels, 
military alliances, and corruption levels are not statistically significant 
factors structuring the relationship between Gazprom and client states (further
discussion of significance levels to come). By posing this as a null hypothesis,
if any one of these relationships are found to be statistically significant, we
can reject the null hypothesis and conduct further analysis on causality. With
regards to the relative significance of each variable, I would hypothesize that
domestic natural gas production rates have the most statistically significant 
inverse relationship with Gazprom reliance. That is to say that as domestic 
natural gas production increases, I would predict some sort of proportional 
decrease in reliance on Gazprom. 

## Data Summary

I constructed the  ‘Gazprom Reliance’ dataset from a variety of different 
publicly available sources. This dataset contains variables related to Gazprom’s
energy diplomacy with 12 different European states, specifically in relation to 
natural gas. It combines data gleaned from Gazprom internal reporting, the 
International Energy Agency (IEA), the World Bank, US Energy Information 
Administration (EIA), and academic literature (Stern 2005). Ten different 
variables have been included in this dataset: year, country, production, Gazprom
imports, natural gas reliance, total energy reliance, difference in reliance, 
geographic status, military alliance, and control of corruption. Given my
research question, the dependent variables are ‘Gazprom_Imports’, 
‘Natural_Gas_Reliance’,and ‘Total Reliance’. Though this dataframe does not 
exactly match any of the research design definitions, it is closest in nature to
a ‘differences in differences’ design because 1) it measures change over time,
2) it is observational insofar that we are not controlling any of the changes, 
and 3) it measures difference across different kinds of ‘interventions’ (e.g.,
NATO membership, corruption levels). 

All the variables included in this dataset were measured in unique ways. Gazprom 
import data was sourced from Gazprom’s annual reports, and thus is largely 
survey-driven data. The other two dependant variables (natural gas reliance and
total reliance) are from an IEA dataset which uses statistical modelling 
combining Total Energy Supply (TES), import data, and production data to output
a percentage integer representing reliance on Russian fuel. The natural gas
reliance variable denotes the reliance on Russian natural gas, whilst the total
reliance variable denotes the reliance on all Russian fossil fuels (including 
oil and coal). Note that there are missing values, such as for reliance in 
Belarus where data was not available. It is also worth noting that Russian 
natural gas exports are equal to Gazprom exports, since Gazprom has monopoly 
control over the Russian natural gas export industry. With regards to some of 
the key independent variables, the control over corruption index is a
statistical model run by The World Bank, and the natural gas production data is
survey data sourced from the IEA. Please also note that when collating this
dataset, I standardized all units for production and imports into billion cubic
metres (bcm). A codebook for this dataset is available upon request!

Below is a summary of the dependant variables in this dataset. 

```{r} 

## Firstly, I need to clean the dataset and make sure all variables are correct

gazprom_data <- read_csv("Gazprom_data.csv")

## There were some empty columns, so this is subsetting to the one's we want

gazprom_data <- subset(gazprom_data, select = c(Year, Country, Production, 
Gazprom_Imports, Natural_Gas_Reliance, Total_Reliance, Difference_in_Reliance, 
Geographic_Status, Military_Alliance, Control_of_Corruption))

## In this section I am converting the % variables into decimal integers

gazprom_data$Natural_Gas_Reliance <- as.numeric(sub("%", "", 
gazprom_data$Natural_Gas_Reliance))/100

gazprom_data$Total_Reliance <- as.numeric(sub("%", "", 
gazprom_data$Total_Reliance))/100

gazprom_data$Difference_in_Reliance <- as.numeric(sub("%", "", 
gazprom_data$Difference_in_Reliance))/100

```

```{r}

## This is a summary plot for the dependent natural gas reliance variable

distinct_colors <- c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00", "#6a3d9a", 
"#b15928", "#a6cee3", "#fdbf6f", "#ffed6f", "#fb9a99", "#cab2d6")

## I'm using distinct colour codes above to make sure the plot is clear

gas_reliance_plot <- ggplot(gazprom_data, aes(x = Year, y = Natural_Gas_Reliance,
group = Country, color = Country)) +
  
geom_line(data = gazprom_data[!is.na(gazprom_data$Natural_Gas_Reliance), ]) +
labs(title = "Reliance on Russian Natural Gas Over Time",
x = "Year",
y = "Natural Gas Reliance (%)",
color = "Country") +
scale_y_continuous(labels = scales::percent_format(scale = 100)) + 
scale_color_manual(values = distinct_colors) +
theme_minimal()

print(gas_reliance_plot)

```

```{r}

## This is a summary plot for the dependent Gazprom imports variable

distinct_colors <- c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00", "#6a3d9a",
"#b15928", "#a6cee3", "#fdbf6f", "#ffed6f", "#fb9a99", "#cab2d6", "#8dd3c7")

imports_plot <- ggplot(gazprom_data, aes(x = Year, y = Gazprom_Imports, group =
Country, color = Country)) +
geom_line(data = gazprom_data[!is.na(gazprom_data$Gazprom_Imports), ]) +
labs(title = "Gazprom Imports Over Time",
x = "Year",
y = "Gazprom Imports (bcm)",
color = "Country") +
scale_color_manual(values = distinct_colors) +
theme_minimal()

print(imports_plot)

```

```{r}
## This is a summary plot for the dependent Total Reliance variable

distinct_colors <- c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00", "#6a3d9a",
"#b15928", "#a6cee3", "#fdbf6f", "#ffed6f", "#fb9a99")

total_reliance_plot <- ggplot(gazprom_data, aes(x = Year, y = Total_Reliance, 
group = Country, color = Country)) +
geom_line(data = gazprom_data[!is.na(gazprom_data$Total_Reliance), ]) +
labs(title = "Total Reliance on Russian Fossil Fuels Over Time",
x = "Year",
y = "Total Reliance (%)",
color = "Country") +
scale_y_continuous(labels = scales::percent_format(scale = 100)) + 
scale_color_manual(values = distinct_colors) +
theme_minimal()

print(total_reliance_plot)

```

